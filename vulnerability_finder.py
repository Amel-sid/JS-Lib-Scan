# vulnerability_finder.py
import requests

def find_cves_for_library(library_name, version, snyk_api_key):
    url = f"https://snyk.io/api/v1/test/npm/{library_name}/{version}"
    headers = {
        "Authorization": f"token {snyk_api_key}"
    }
    try:
        response = requests.get(url, headers=headers)
        response.raise_for_status()  # Cela va déclencher une exception pour les réponses 4xx/5xx
        cve_list = [item['id'] for item in response.json().get('vulnerabilities', [])]
        return cve_list
    except requests.RequestException as e:
        print(f"Error fetching CVEs for {library_name}: {e}")
        return None
